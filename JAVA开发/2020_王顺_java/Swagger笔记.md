#ç‹‚ç¥çš„Swaggerç¬”è®°
## ç‹‚ç¥çš„Swaggerç¬”è®°

è§†é¢‘é“¾æ¥ï¼šhttps://www.bilibili.com/video/BV1Y441197Lw?from=search&amp;seid=5187609033853264629

å­¦ä¹ ç›®æ ‡ï¼š
- äº†è§£Swaggerçš„ä½œç”¨å’Œæ¦‚å¿µ- äº†è§£å‰åç«¯åˆ†ç¦»- åœ¨SpringBootä¸­é›†æˆSwagger
## Swaggerç®€ä»‹

**å‰åç«¯åˆ†ç¦»**

Vue + SpringBoot 

åç«¯**æ—¶ä»£**ï¼šå‰ç«¯åªç”¨ç®¡ç†é™æ€é¡µé¢ï¼›html â‡’ åç«¯ã€‚æ¨¡æ¿å¼•æ“JSP â‡’ åç«¯æ˜¯ä¸»åŠ›ã€‚

å‰åç«¯åˆ†ç¦»æ—¶ä»£ï¼š
-  åç«¯ï¼š==åç«¯æ§åˆ¶å±‚==ï¼Œ==æœåŠ¡å±‚==ï¼Œ==æ•°æ®è®¿é—®å±‚==ã€åç«¯å›¢é˜Ÿã€‘ 
  
-  å‰ç«¯ï¼š==å‰ç«¯æ§åˆ¶å±‚==ï¼Œ==è§†å›¾å±‚==ã€å‰ç«¯å›¢é˜Ÿã€‘ 
  
  <ul>- ä¼ªé€ åç«¯æ•°æ®ï¼Œjsonã€‚å·²ç»å­˜åœ¨äº†ï¼Œä¸éœ€è¦åç«¯ï¼Œå‰ç«¯å·¥ç¨‹ä¾æ—§èƒ½å¤Ÿè·‘èµ·æ¥ã€‚
  å‰åç«¯å¦‚ä½•äº¤äº’ï¼Ÿ ===&gt; API

å‰åç«¯ç›¸å¯¹ç‹¬ç«‹ï¼Œæ¾è€¦åˆï¼›

å‰åç«¯ç”šè‡³å¯ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼›

äº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼š
- å‰åç«¯é›†æˆè”è°ƒï¼Œå‰ç«¯äººå‘˜æ— æ³•å’Œåç«¯äººå‘˜æ— æ³•åšåˆ°ï¼Œâ€œå³æ—¶åå•†ï¼Œå°½æ—©è§£å†³â€ï¼Œæœ€ç»ˆå¯¼è‡´é—®é¢˜é›†ä¸­çˆ†å‘ï¼›
è§£å†³æ–¹æ¡ˆï¼š
-  é¦–å…ˆæŒ‡å®šschema[è®¡åˆ’çš„æçº²]ï¼Œå®æ—¶æ›´æ–°æœ€æ–°APIï¼Œé™ä½é›†æˆçš„é£é™©ï¼› -  æ—©äº›å¹´ï¼šæŒ‡å®šwordè®¡åˆ’æ–‡æ¡£ï¼› <li> å‰åç«¯åˆ†ç¦»ï¼š 
  
  <ul>- å‰ç«¯æµ‹è¯•åç«¯æ¥å£ï¼špostman- 
      åç«¯æä¾›æ¥å£ï¼Œéœ€è¦å®æ—¶æ›´æ–°æœ€æ–°çš„æ¶ˆæ¯åŠæ”¹åŠ¨ï¼

## Swagger

- å·ç§°ä¸–ç•Œä¸Šæœ€æµè¡Œçš„Apiæ¡†æ¶- RestFul Api æ–‡æ¡£åœ¨çº¿è‡ªåŠ¨ç”Ÿæˆå·¥å…· =&gt; <mark>Apiæ–‡æ¡£ä¸Apiå®šä¹‰åŒæ­¥æ›´æ–°</mark>- ç›´æ¥è¿è¡Œï¼Œå¯ä»¥åœ¨çº¿æµ‹è¯•APIæ¥å£ï¼›- æ”¯æŒå¤šç§è¯­è¨€ï¼šï¼ˆJavaã€Phpâ€¦ï¼‰
å®˜ç½‘ï¼šhttps://swagger.io/

åœ¨é¡¹ç›®ä¸­ä½¿ç”¨swaggeréœ€è¦springboxï¼›
- swagger2
-  ui
## SpringBooté›†æˆSwagger
1. æ–°å»ºä¸€ä¸ªSpringBoot - webé¡¹ç›®1. å¯¼å…¥ç›¸å…³ä¾èµ– <img src="https://img-blog.csdnimg.cn/20210121215648715.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01lbW9yaWVzTmFuZ29uZw==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">
```xml
<!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 -->
<dependency>
<groupId>io.springfox</groupId>
<artifactId>springfox-swagger2</artifactId>
<version>3.0.0</version>
</dependency>

<!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui -->
<dependency>
<groupId>io.springfox</groupId>
<artifactId>springfox-swagger-ui</artifactId>
<version>3.0.0</version>
</dependency>
```
1. ç¼–å†™ä¸€ä¸ªHelloå·¥ç¨‹1. é…ç½®Swagger ==&gt; Config
```java
package com.kuang.swagger.config;

import org.springframework.context.annotation.Configuration;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@Configuration
@EnableSwagger2   // å¼€å¯Swagger2
public class SwaggerConfig {

    
}

```
1. æµ‹è¯•è¿è¡Œ http://localhost:8080/swagger-ui.html<img src="https://img-blog.csdnimg.cn/20210121233447652.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01lbW9yaWVzTmFuZ29uZw==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">
## é…ç½®Swagger

swaggerçš„beanå®ä¾‹Docketï¼›ï¼ˆ<mark>åœ¨ä¸Šé¢SwaggerConfig ç±»ä¸­æ·»åŠ </mark>ï¼‰

```
@Configuration
@EnableSwagger2   // å¼€å¯Swagger2
public class SwaggerConfig {<!-- -->

    //é…ç½®äº†swaggerçš„Docket çš„ bean å®ä¾‹
    @Bean
    public Docket docket(){<!-- -->
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo());
    }
    //é…ç½® swagger ä¿¡æ¯ = apiInfo
    private ApiInfo apiInfo(){<!-- -->
        //ä½œè€…ä¿¡æ¯
        Contact contact = new Contact("ç§¦ç–†", "https://blog.kuangstudy.com/", "24736743@qq.com");
        return new ApiInfo("ç‹‚ç¥çš„SwaggerAPIæ–‡æ¡£",
                "å³æ—¶åœ¨å°çš„å¸†ä¹Ÿèƒ½è¿œèˆª",
                "v1.0",
                "http://blog.kuangstudy.com/",
                contact,
                "Apache 2.0",
                "http://www.apache.org/licenses/LICENSE-2.0",
                new ArrayList()
        );
    }
}

```

## Swaggeré…ç½®æ‰«ææ¥å£

Docket.select() <mark>æ¥ç€ä¸Šé¢çš„docket() è®²è§£</mark>

```
//é…ç½®äº†swaggerçš„Docket çš„ bean å®ä¾‹
    @Bean
    public Docket docket(){<!-- -->
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .select()
                // RequestHandlerSelectors, é…ç½®è¦æ‰«æçš„åŒ…
                // basePackage(): æŒ‡å®šè¦æ‰«æçš„åŒ…
                // any(): æ‰«æå…¨éƒ¨
                // none(): éƒ½ä¸æ‰«æ
                // withClassAnnotation : æ‰«æç±»ä¸Šçš„æ³¨è§£, å‚æ•°æ˜¯ä¸€ä¸ªæ³¨è§£çš„åå°„å¯¹è±¡
                // ä¾‹å¦‚ï¼šwithClassAnnotation(RestController.class) åªæ‰«æç±»ä¸Šæœ‰@RestControllerçš„ç”Ÿæˆæ–‡æ¡£
                // withMethodAnnotation: æ‰«ææ–¹æ³•ä¸Šçš„æ³¨è§£, å‚æ•°æ˜¯ä¸€ä¸ªæ³¨è§£çš„åå°„å¯¹è±¡
                .apis(RequestHandlerSelectors.basePackage("com.kuang.swagger.controller"))
                // paths(): è¿‡æ»¤ä»€ä¹ˆè·¯å¾„
                .paths(PathSelectors.ant("/kuang/**"))
                .build();  //build
    }

```

é…ç½®æ˜¯å¦å¯åŠ¨Swaggerï¼ˆ**enable æ˜¯å¦å¯åŠ¨Swaggerï¼Œ å¦‚æœä¸ºfalseï¼Œ åˆ™Swagger ä¸èƒ½å†æµè§ˆå™¨ä¸­è®¿é—®**ï¼‰ <img src="https://img-blog.csdnimg.cn/20210122002055264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01lbW9yaWVzTmFuZ29uZw==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> é—®é¢˜ï¼šæˆ‘åªå¸Œæœ›æˆ‘çš„Swaggeråœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œåœ¨å‘å¸ƒçš„æ—¶å€™ä¸ä½¿ç”¨ï¼Ÿ è§£é¢˜æ€è·¯ï¼š
- åˆ¤æ–­æ˜¯ä¸æ˜¯ç”Ÿäº§ç¯å¢ƒ flag = false- æ³¨å…¥enable(flag)
è§£é¢˜æ­¥éª¤ï¼š 1.å…ˆåœ¨resourcesç›®å½•ä¸‹åˆ›å»ºä¸¤ä¸ªpropertiesæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ <img src="https://img-blog.csdnimg.cn/20210122162603350.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> æ¥ä¸‹æ¥åœ¨application.propertiesæ–‡ä»¶ä¸­æ¿€æ´»ç¯å¢ƒ

```
spring.profiles.active=dev

```

åœ¨application-dev.propertiesä¸­

```
server.port=8081

```

åœ¨application-pro.propertiesä¸­

```
server.port=8082

```

2.<mark>æ¥ç€ä¸Šé¢çš„docket()</mark>ï¼Œåœ¨æ–¹æ³•ä¸­åŠ å…¥å½¢å‚Environmentè·å–application.propertiesä¸­çš„è®¾ç½®çš„ç¯å¢ƒ

```
 @Bean
 public Docket docket(Environment environment){<!-- -->
     // è®¾ç½®è¦æ˜¾ç¤ºçš„Swaggerç¯å¢ƒ
     Profiles profiles = Profiles.of("dev", "test");
     // é€šè¿‡ environment.acceptsProfiles(profiles) åˆ¤æ–­æ˜¯å¦å¤„åœ¨è‡ªå·±è®¾å®šçš„ç¯å¢ƒå½“ä¸­
     boolean flag = environment.acceptsProfiles(profiles);


     return new Docket(DocumentationType.SWAGGER_2)
             .apiInfo(apiInfo())
             //æ­¤å¤„åˆ¤æ–­æ˜¯ç”Ÿäº§ç¯å¢ƒ flag å°±æ˜¯ä¸ºtrue å°±å¯ä»¥è®¿é—®Swagger
             .enable(flag)
             
             .select()
             .apis(RequestHandlerSelectors.basePackage("com.kuang.swagger.controller"))
//                .paths(PathSelectors.ant("/kuang/**"))
             .build();  //build
 }

```

3.åœ¨æµè§ˆå™¨ä¸Šè¯·æ±‚http://localhost:8081/swagger-ui.html#/å°±å¯ä»¥è®¿é—®Swaggerï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹spring.profiles.activeä¸ºpro

```
spring.profiles.active=pro

```

ç„¶ååœ¨æµè§ˆå™¨ä¸Šè¯·æ±‚http://localhost:8082/swagger-ui.html#/ä¼šå‡ºç°ğŸ˜± Could not render e, see the console.

## é…ç½®APIæ–‡æ¡£çš„åˆ†ç»„

```
.groupName("ç‹‚ç¥")

```

é…ç½®å¤šä¸ªåˆ†ç»„ï¼Œå¤šä¸ªDocketå®ä¾‹å³å¯

```
 @Bean
 public Docket docket1(){<!-- -->
     return new Docket(DocumentationType.SWAGGER_2).groupName("A");
 }
 @Bean
 public Docket docket2(){<!-- -->
     return new Docket(DocumentationType.SWAGGER_2).groupName("B");
 }
 @Bean
 public Docket docket3(){<!-- -->
     return new Docket(DocumentationType.SWAGGER_2).groupName("C");
 }

```

Swaggerä¸­å°±ä¼šå‡ºç°å¤šä¸ªåˆ†ç»„ <img src="https://img-blog.csdnimg.cn/20210122165758163.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">

```
package com.kuang.swagger.pojo;

import io.swagger.annotations.ApiModel;
import io.swagger.annotations.ApiModelProperty;

@ApiModel("ç”¨æˆ·å®ä½“ç±»")
public class User {<!-- -->

    @ApiModelProperty("ç”¨æˆ·å")
    public String username;
    @ApiModelProperty("å¯†ç ")
    public String password;
}


```

controller

```
package com.kuang.swagger.controller;

import com.kuang.swagger.pojo.User;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiParam;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloController {<!-- -->

    @GetMapping(value = "/hello")
    public String hello(){<!-- -->
        return "hello";
    }

    // åªè¦æˆ‘ä»¬çš„æ¥å£ä¸­ï¼Œè¿”å›å€¼ä¸­å­˜åœ¨å®ä½“ç±», ä»–å°±ä¼šæ‰«æåˆ°Swaggerä¸­
    @PostMapping(value = "/user")
    public User user(){<!-- -->
        return new User();
    }

    @ApiOperation("helloæ§åˆ¶ç±»")
    @GetMapping(value = "/hello2")
    public String hello2(@ApiParam("ç”¨æˆ·å") String username){<!-- -->
        return "hello " + username;
    }
    @ApiOperation("Postæµ‹è¯•ç±»")
    @GetMapping(value = "/postt")
    public User postt(@ApiParam("ç”¨æˆ·å") User user){<!-- -->
        return user;
    }
}

```

## æ€»ç»“
1. æˆ‘ä»¬å¯ä»¥é€šè¿‡Swaggerç»™ä¸€äº›æ¯”è¾ƒæ¯”è¾ƒéš¾ç†è§£çš„å±æ€§åæ¥å£ï¼Œå¢åŠ æ³¨é‡Šä¿¡æ¯1. æ¥å£æ–‡æ¡£å®æ—¶æ›´æ–°1. å¯ä»¥åœ¨çº¿æµ‹è¯•
æœ¬æ–‡ç« å®Œå…¨é€šè¿‡å­¦ä¹ ç‹‚ç¥çš„swaggerè§†é¢‘ï¼Œè§†é¢‘é“¾æ¥åœ¨æ–‡ç« å¼€å¤´ï¼Œç¬”è®°å¯èƒ½ä¼šæœ‰å°ä¿®æ”¹ï¼Œå¦‚æœ‰é”™è¯¯è¯·ç»™æˆ‘è¯„è®ºã€‚
